C51 COMPILER V9.54   MAIN                                                                  01/12/2016 12:52:00 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main
                    -.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <reg51.h>
   2          #include "../lib/lcd.h"
   3          
   4          //declare variables
   5          sbit COL1 = P1^0;
   6          sbit COL2 = P1^1;
   7          sbit COL3 = P1^2;
   8          sbit COL4 = P1^3;
   9          sbit ROW1 = P1^4;
  10          sbit ROW2 = P1^5;
  11          sbit ROW3 = P1^6;
  12          sbit ROW4 = P1^7;
  13          
  14          //functions
  15          void init();
  16          void keyboard_scan_init();
  17          unsigned char scan(unsigned char row);
  18          void lcd_display(unsigned char pos);
  19          
  20          void main(void) { 
  21   1        init();
  22   1        lcd_display(1);
  23   1        while(1);
  24   1      }
  25          
  26          void init() {
  27   1        IE   = 0x81;
  28   1        IT0  = 1;
  29   1        
  30   1        ROW1 = 0;
  31   1        ROW2 = 0;
  32   1        ROW3 = 0;
  33   1        ROW4 = 0;
  34   1      }
  35          
  36          void external_interrupt_isr(void) interrupt 0 {
  37   1        unsigned char i   = 0;
  38   1        unsigned char pos = 0, tmp=0;
  39   1        
  40   1        keyboard_scan_init();
  41   1        
  42   1        for (i=1; i<=4; ++i) {
  43   2          tmp = scan(i);
  44   2          if (tmp != 0) {
  45   3            break;
  46   3          }
  47   2        }
  48   1        if (tmp != 0) {
  49   2          pos = tmp;
  50   2        }
  51   1          
  52   1        lcd_display(pos);
  53   1        
  54   1        init();
C51 COMPILER V9.54   MAIN                                                                  01/12/2016 12:52:00 PAGE 2   

  55   1      }
  56          
  57          void lcd_display(unsigned char pos) {
  58   1        pos = 1;
  59   1        lcd_cmd(0x01);
  60   1        lcd_cmd(0x0E);
  61   1        lcd_data('A');
  62   1      }
  63          
  64          void keyboard_scan_init() {
  65   1        IE  = 0x00;
  66   1        
  67   1        ROW1 = 0;
  68   1        ROW2 = 0;
  69   1        ROW3 = 0;
  70   1        ROW4 = 0;
  71   1      }
  72          unsigned char scan(unsigned char row) {
  73   1        unsigned char col = 0;
  74   1        
  75   1        switch(row) {
  76   2          case 1:
  77   2            ROW1 = 0;
  78   2            break;
  79   2          
  80   2          case 2:
  81   2            ROW2 = 0;
  82   2            break;
  83   2          
  84   2          case 3:
  85   2            ROW3 = 0;
  86   2            break;
  87   2          
  88   2          case 4:
  89   2            ROW4 = 0;
  90   2            break;
  91   2          
  92   2          default:
  93   2            break;
  94   2        }
  95   1        
  96   1        if (COL1 == 0) {
  97   2          col  = 1;
  98   2          COL1 = 1;
  99   2        } else if (COL2 == 0) {
 100   2          col  = 2;
 101   2          COL2 = 1;
 102   2        } else if (COL3 == 0) {
 103   2          col  = 3;
 104   2          COL3 = 1;
 105   2        } else if (COL4 == 0) {
 106   2          col  = 4;
 107   2          COL4 = 1;
 108   2        }
 109   1        
 110   1        (ROW1 == 0) ? (ROW1 = 1) : 1;
*** WARNING C275 IN LINE 110 OF main.c: expression with possibly no effect
 111   1        (ROW2 == 0) ? (ROW2 = 1) : 1;
*** WARNING C275 IN LINE 111 OF main.c: expression with possibly no effect
 112   1        (ROW3 == 0) ? (ROW3 = 1) : 1;
*** WARNING C275 IN LINE 112 OF main.c: expression with possibly no effect
 113   1        (ROW4 == 0) ? (ROW4 = 1) : 1;
C51 COMPILER V9.54   MAIN                                                                  01/12/2016 12:52:00 PAGE 3   

*** WARNING C275 IN LINE 113 OF main.c: expression with possibly no effect
 114   1        
 115   1        if (col != 0) {
 116   2          return ((row-1)*4 + col);
 117   2        }
 118   1        
 119   1        return 0;
 120   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    256    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  4 WARNING(S),  0 ERROR(S)
